module example.test;

import java.lang;
import panda.lang;
import org.panda_lang.panda;
import org.panda_lang.panda.bootstrap;
import org.panda_lang.panda.language.syntax;
import org.panda_lang.panda.language.structure.prototype.registry;
import org.panda_lang.panda.design.architecture;

class Foo extends Test {

    method anotherEcho(String message) {
        Console.print(message);
    }

}

class Test {

    hidden mutable Test testField;
    hidden Double i = 1.0D;

    constructor(String message) {
        Console.print(message);
        this.testField = this;
        testField = this;
        // this.echo(i.intValue());
        // echo(this.i.intValue());
    }

    method echo(Object message) {
        Console.print(message);
    }

    method testField() {
        this.echo(this.getTestField());
    }

    method Test getTestField() {
        return this.testField;
    }

 }

main {
    String init;
    nullable Object req = null;

    Test test = new Test('"Constructor"');
    test.echo("Method");
    test.testField();

    nullable mutable Foo varFoo = null;
    varFoo = new Foo();

    mutable String s = "Hello Panda v1";
    s = "Hello Panda v2";

    Int i = 0x000001;
    Int math = 10 + (3 + 4 + i) * 2 /*+ "test" */;
    Boolean flag = true;

    Console.print("Hello Panda", flag, varFoo, s, test, i);
    System.out.println(math);

    if (false) {
        Console.print("Nope");
    }
    else {
        Console.print("Yay");
    }

    loop (i) {
        Console.print("Loop x1");

        loop (i) {
            Console.print("Loop x2");
            break;
        }

        continue;
        Console.print("Loop x3");
    }

    while (flag) {
        Console.print("While x1");
        break;
    }

    Console.print("Calling mapped Panda from Panda");
    Panda panda = new PandaBootstrap()
            .syntax(PandaSyntax.getInstance())
            .mapModels(ClassPrototypeModel.of("panda.lang"))
            .get();

    PandaApplication application = new PandaApplicationBootstrap(panda)
            .source("../examples/main.panda")
            .createApplication();

    Console.print("Launching mapped Panda from Panda");
    application.launch();
}